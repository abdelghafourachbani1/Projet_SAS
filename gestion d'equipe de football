#include <stdio.h>
#include <string.h>

typedef struct {
    int id ;
    char nom[20] ;
    char prenom[20] ;
    int numero_maillot;
    char post[10];
    int age;
    int buts;
} joueur;

int nombre_joueur = 10;
int counter_id = 110;

   joueur j[30] = {
    {100,"lionel","messi",10,"attaquant",38,91},
    {101,"zakaria","hedraf",11,"attaquant",40,35},
    {102,"yassine","bono",1,"gardien",28,0},
    {103,"youssef","moti3",1,"gardien",25,0},
    {104,"xavi","simonz",8,"milieu",27,15},
    {105,"toni","kros",6,"milieu",32,9},
    {106,"sergio","ramos",4,"defenseur",35,2},
    {107,"lamine","yamal",19,"attaquant",18,25},
    {108,"luis","diaz",7,"attaquant",23,30},
    {109,"mohamed","salah",12,"attaquant",30,40}
};   


void ajoute_joueur () {
    int p;
       if (30 > nombre_joueur) {
            printf("entre le nom du joueur : \n");
            scanf("%s",j[nombre_joueur].nom);
            printf("entre le prenom du joueur : \n");
            scanf("%s",j[nombre_joueur].prenom);
            printf("entre le numero du maillot du joueur : \n");
            scanf("%d",&j[nombre_joueur].numero_maillot);
          
            menu_poste : {
                printf("entre le poste du joueur : \n");
                printf("1 => guardien ; 2 => defenseur ; 3 => milieu ; 4 => attaquant \n");
            }
                scanf("%d",&p);
                switch (p) {
                case 1:
                    strcpy(j[nombre_joueur].post,"guardien");
                    break;
                case 2:
                    strcpy(j[nombre_joueur].post,"defenseur");
                    break;
                case 3:
                    strcpy(j[nombre_joueur].post,"milieu");
                    break;
                case 4:
                    strcpy(j[nombre_joueur].post,"attaquant");
                    break;
                default :
                    printf("error! entrer un nombre entre 1 et 4 ");
                    goto menu_poste;
                    break;
                }
        
           j[nombre_joueur].id = counter_id++;
           printf("entrer l'age du joueur : \n");
           scanf("%d",&j[nombre_joueur].age);
           printf("entrer le nombre des buts du joueur : \n");
           scanf("%d",&j[nombre_joueur].buts);
           nombre_joueur++;
        } else {
           printf("la liste des joueurs est complete : ");
        }
} 
void ajoute_plusieur_joueur() {
    int x;
    printf("entrer le nombre du joueur que tu veux ajouter : \n");
    scanf("%d", &x);
        for (i = 0;i < x;i++) {
            ajoute_joueur();
        }
}

void afficher_joueurs() {
    for (int i = 0; i < nombre_joueur; i++) {
        printf("nom : %s ; prenom : %s ;numero_maillot : %d ; post : %s ; age du joueur : %d ; id : %d ",j[i].nom,j[i].prenom,j[i].numero_maillot,j[i].post,&j[i].age,&j[i].id);
    }
}

void tri_alphabetique() {
    joueur variable_temporaire;
    for (int i = 0; i < nombre_joueur-1;i++) {
        for (int j = 0; j < nombre_joueur-1-i;j++) {
            if (strcmp(j[j].nom, j[j+1].nom) > 0) {
                variable_temporaire = j[j];
                j[j] = j[j+1];
                j[j+1] = variable_temporaire;
            }
        }
    }
    printf("tri par ordre alphabetique \n");
    afficher_joueurs();
}
void tri_age() 
void tri_poste() {
    char poste_entrer[10];
    printf("entrer le post (gardien/defenseur/milieu/attaquant) : ");
    scanf("%s", poste_entrer);

    printf("joueurs a le poste %s \n",poste_entrer);
    for (int i = 0; i < nombre_joueur; i++) {
        if (strcmp(j[i].post,poste_entrer) == 0) {
             printf("nom : %s ; prenom : %s ;numero_maillot : %d ; post : %s ; age du joueur : %d ; id : %d ",j[i].nom,j[i].prenom,j[i].numero_maillot,j[i].post,&j[i].age,&j[i].id);
        }
    }
}

void modification_poste() {
     int id;
    printf("entrer l'id du joueur pour modifier : \n");
        scanf("%d",&id);

    for (int i = 0; i < nombre_joueur; i++) {
        if (j[i].id == id) {
            int choix;
            menu_poste : {
            printf("1 => gardien ; 2 => defenseur ; 3 => milieu ; 4 => attaquant \n");
            printf("entrer le nouvelle poste : \n");
        }
                scanf("%d", &choix);
            switch (choix) {
                case 1: 
                   strcpy(j[i].poste,"gardien"); 
                   break;
                case 2: 
                    strcpy(j[i].poste,"defenseur"); 
                    break;
                case 3: 
                    strcpy(j[i].poste,"milieu"); 
                    break;
                case 4: 
                    strcpy(j[i].poste,"attaquant"); 
                    break;
                default: 
                    printf("error! entrer un entier entre 1 et 4 : \n"); 
                    goto menu_poste;
                    break;
            }
            printf("le poste  a ete modifier en succe : \n");
            return;
        }
    }
    printf("la joueur avec l'id %d n'exist pas dans la liste des joueurs ; \n",id);
}
void modification_age() {
   int id, nouvelle_age;
    printf("entrer l'id de joueur pour modifier : \n");
       scanf("%d",&id);

    for (int i = 0; i < nombre_joueur; i++) {
        if (j[i].id == id) {
            printf("entrer la nouvelle age : ");
            scanf("%d",&nouvelle_age);
            j[i].age = nouvelle_age;
            printf("l'age du joueur a ete modifier en sucee : \n");
            return;
        }
    }
    printf("la joueur avec l'id %d n'exist pas dans la liste des joueurs ; \n",id);
}
void modification_buts() {
     int id, nouvelle_buts;
    printf("entrer l'id de joueur pour modifier : \n");
       scanf("%d",&id);

    for (int i = 0; i < nombre_joueur; i++) {
        if (j[i].id == id) {
            printf("entrer la nouvelle nombre des buts : \n");
            scanf("%d",&nouvelle_buts);
            j[i].buts = nouvelle_buts;
            printf("le nombre de but du joueur a ete modifier en sucee : \n");
            return;
        }
    }
    printf("la joueur avec l'id %d n'exist pas dans la liste des joueurs ; \n",id);
}

void supretion(); {
    int id,i,k;
    printf("entrer l 'id du joueur pour modifier : ");
    scanf("%d", &id);

    for (i = 0; i < nombre_joueur; i++) {
        if (j[i].id == id) {
             for (k = i; k < nombre_joueur-1; k++) {
                j[k] = j[k+1];
            }
            nombre_joueur--; 
            printf("le joueur avec l'id %d a ete suprime en succe  \n", id);
            return; 
        }
    }

}

void recherche_id() {
    int id;
    printf("entrer l'id du joueur que tu veux cherche : \n");
    scanf("%d", &id);

    for (int i = 0; i < nombre_joueur; i++) {
        if (j[i].id == id) {
            printf("nom : %s ; prenom : %s ;numero_maillot : %d ; post : %s ; age du joueur : %d ; id : %d ",j[i].nom,j[i].prenom,j[i].numero_maillot,j[i].post,&j[i].age,&j[i].id); 
            return;
        }
    }
    printf("la joueur avec l'id %d n'exist pas dans la liste des joueurs ; \n",id);
}
void recherche_nom() {
     char nom[20];
    printf("entrer le nombre du joueur que tu veux cherche : \n");
    scanf("%s",nom);

    int trv = 0;
    for (int i = 0; i < nombre_joueur; i++) {
        if (strcmp(j[i].nom,nom) == 0) {
            printf("nom : %s ; prenom : %s ;numero_maillot : %d ; post : %s ; age du joueur : %d ; id : %d ",j[i].nom,j[i].prenom,j[i].numero_maillot,j[i].post,&j[i].age,&j[i].id);
            trv++;;
        }
    }
    if (trv == 0) {
       printf("la joueur avec le nom %s n'exist pas dans la liste des joueurs ; \n",nom);
    }
}

void affiche_age_moyenne() {
    if (nombre_joueur == 0) {
    int i ,somme = 0;
    float moyenne;
        printf("la liste est empty.\n");
        return;
    }
    for (int i = 0; i < nombre_joueur; i++) {
        somme += j[i].age;
    }
    moyenne = somme/nombre_joueur;
    printf("l'age moyenne des joueurs est : %.2f ans \n",moyenne);
}
void affiche_joueur_marque_plusX() {
    int x;
    printf("entrer le nombre des buts  : ");
    scanf("%d", &X);

    int trv = 0;
    for (int i = 0; i < nombre_joueur; i++) {
        if (j[i].buts > X) {
            printf("nom : %s ; prenom : %s ;numero_maillot : %d ; post : %s ; age du joueur : %d ; id : %d ",j[i].nom,j[i].prenom,j[i].numero_maillot,j[i].post,&j[i].age,&j[i].id);
            trv++;
        }
    }
    if (trv == 0) {
        printf("aucune joueur marque plus de %d des buts : ",x);
    }
}
void affiche_buteur() {
       if (nombre_joueur == 0) {
        printf("la liste d'equipe est empty \n");
        return;
    }
    int max = j[0].buts;
    int indice_butteur = 0;
    for (int i = 1; i < nombre_joueur; i++) {
        if (j[i].buts > max) {
            max = j[i].buts;
            index = i;
        }
    }
    printf("nom : %s ; prenom : %s ;numero_maillot : %d ; post : %s ; age du joueur : %d ; id : %d ",j[indice_butteur].nom,j[indice_butteur].prenom,j[indice_butteur].numero_maillot,j[indice_butteur].post,&j[indice_butteur].age,&j[indice_butteur].id); 
}
void affiche_plusjeune_plusage() {
     if (nombre_joueur == 0) {
        printf("la liste d'equipe est empty \n");
        return;
    }
    int min_age = j[0].age;
    int index_min_age = 0;

    for (int i = 1; i < nombre_joueur; i++) {
        if (j[i].age < min_age) {
            min_age = j[i].age;
            index_min__age = i;
        }
    }
    int max_age = j[0].age;
    int index_max_age = 0;
    for (int i = 1; i < nombre_joueur; i++) {
        if (j[i].age > max_age) {
            max_age = j[i].age;
            index_max_age = i;
        }
    }
    printf("le joueur le plus age : \n");
    printf("nom : %s ; prenom : %s ;numero_maillot : %d ; post : %s ; age du joueur : %d ; id : %d \n",j[index_min__age].nom,j[index_min__age].prenom,j[index_min__age].numero_maillot,j[index_min__age].post,&j[index_min__age].age,&j[index_min__age].id);
    
    printf("le joueur le plus jeune : \n");
    printf("nom : %s ; prenom : %s ;numero_maillot : %d ; post : %s ; age du joueur : %d ; id : %d \n",j[].nom,j[index_max__age].prenom,j[index_max__age].numero_maillot,j[index_max__age].post,&j[index_max__age].age,&j[index_max__age].id);
}

int main() {

    int  id_joueur = 110;
    int choix_principale ,choix_ajoute ,choix_affiche ,choix_modification ,choix_statistiques;
    
    
    menu : {
    printf("=========menu==========\n");
    printf("1 => Ajouter un joueur : \n");
    printf("2 => Afficher la liste de tous les joueurs : \n");
    printf("3 => Modifier un joueur : \n");
    printf("4 => Supprimer un joueur : \n");
    printf("5 => Rechercher un joueur : \n");
    printf("6 => Statistiques : : \n");
    }
      scanf("%d",&choix_principale);
       
    switch (choix_principale) {
        case 1 :
            
            menu1 : {
            printf("1 => ajoute une joueur : \n");
            printf("2 => ajoute plusieur joueur : \n");
            printf("3 => reteur au menu principale : \n");
            }
              scanf("%d",&choix_ajoute);
              
               switch(choix_ajoute){
                
                   case 1: ajoute_joueur();
                        goto menu1;
                        break;
                   case 2: ajoute_plusieur_joueur();
                        goto menu1;
                        break;
                   case 3: goto menu;
                       break;
                    default: printf("entrer un nombre entre 1 et 3 : ");
                       goto menu1; 
                      break;
            }
            
           break;
        case 2 : 
            menu2 : {
                printf("1 => Trier les joueurs par ordre alphabétique (Nom) : \n");
                printf("2 => Trier les joueurs par âge. : \n");
                printf("3 => Afficher les joueurs par poste. : \n");
                printf("4 => reteur au menu principale : \n");
            }
            scanf("%d",&choix_affiche);
            
            switch(choix_affiche) {
                case 1 : 
                    tri_alphabetique(); 
                    goto menu2;
                    break;
                case 2 : 
                    tri_age();
                    goto menu2;
                    break;
                case 3 : 
                   tri_poste();
                   goto menu2;
                   break;
                case 4: goto menu; 
                       break;
                default: printf("entrer un nombre entre 1 et 4 : \n");
                       goto menu2; 
                      break;
            }
            
           break;
        case 3 : 
             menu3 : {
                 printf("Modifier le poste d’un joueur : \n");
                 printf("Modifier l’âge d’un joueur: \n");
                 printf("Modifier le nombre de buts marqués par un joueur : \n");
                 printf("4 => reteur au menu principale : \n");
             }
             scanf("%d",&choix_modification);
             
            switch(choix_modification) {
                case 1 : 
                    modification_poste(); 
                    goto menu3;
                    break;
                case 2 : 
                    modification_age();
                    goto menu3;
                    break;
                case 3 : 
                    modification_buts();
                    goto menu3;
                    break;
                case 4: goto menu; 
                       break;
                default: printf("entrer un nombre entre 1 et 4 : ");
                       goto menu3; 
                      break;
            }
             
           break;
        case 4 :
            supretion();
           break;
        case 5 :
           menu4 : {
               printf("1 => recherche par id : \n");
               printf("2 => recherche par nom : \n");
               printf("3 => reteur au menu principale : \n");
           }
           scanf("%d",&choix_recherche);
           
           case 1 : 
               recherche_id();
               goto menu4;
               break;
           case 2 : 
               recherche_nom();
               goto menu4;
               break;
           case 3 : goto menu;
               break;
           default: printf("entrer un nombre entre 1 et 3 : ");
                       goto menu4; 
                      break;
           
        case 6 :
           menu5 : {
               printf("1 => Afficher le nombre total de joueurs dans l’équipe : \n");
               printf("2 => Afficher l’âge moyen des joueurs : \n");
               printf("3 => Afficher les joueurs ayant marqué plus de X buts (X introduit par l’utilisateur) : \n");
               printf("4 => Afficher le meilleur buteur (joueur avec le maximum de buts) : \n");
               printf("5 => Afficher le joueur le plus jeune et le plus âgé : \n");
               printf("6 => reteur au menu principale : \n");
           }
           scanf("%d",choix_statistiques);
           
           switch (choix_statistiques) {
               case 1 : 
                  printf("le nombre total du joueurs dans la liste est : %d\n", nombre_joueur);
                  goto menu5;
                  break;
               case 2 : 
                  affiche_age_moyenne();
                  goto menu5;
                  break;
               case 3 : 
                  affiche_joueur_marque_plusX();
                  goto menu5;
                  break;
               case 4 : 
                  affiche_buteur();
                  goto menu5;
                  break;
               case 5 : 
                  affiche_plusjeune_plusage();
                  goto menu5;
                  break;
               case 6 : goto menu;
               break;
            default: printf("entrer un nombre entre 1 et 6 : ");
                       goto menu5; 
                      break;  
           }
           
           break;
        default : printf("saisir une nombre entre (1/6) : \n");
                 goto menu;  
           break ;
    }

    
    return 0;
}
