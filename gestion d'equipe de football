#include <stdio.h>
#include <string.h>

typedef struct {
    int id ;
    char nom[20] ;
    char prenom[20] ;
    int numero_maillot;
    char poste[20];
    int age;
    int buts;
} joueur;

int nombre_joueur = 10;
int counter_id = 110;

   joueur j[30] = {
    {100,"lionel","messi",10,"attaquant",38,91},
    {101,"zakaria","hedraf",11,"attaquant",40,35},
    {102,"yassine","bono",1,"gardien",28,0},
    {103,"youssef","moti3",1,"gardien",25,0},
    {104,"xavi","simonz",8,"milieu",27,15},
    {105,"toni","kros",6,"milieu",32,9},
    {106,"sergio","ramos",4,"defenseur",35,2},
    {107,"lamine","yamal",19,"attaquant",18,25},
    {108,"luis","diaz",7,"attaquant",23,30},
    {109,"mohamed","salah",12,"attaquant",30,40}
};   


void ajoute_joueur () {
    int p;
       if (30 > nombre_joueur) {
            printf("entre le nom du joueur : \n");
            scanf("%s",j[nombre_joueur].nom);
            printf("entre le prenom du joueur : \n");
            scanf("%s",j[nombre_joueur].prenom);
            printf("entre le numero du maillot du joueur : \n");
            scanf("%d",&j[nombre_joueur].numero_maillot);
          
            menu_poste : {
                printf("entre le poste du joueur : \n");
                printf("1 => guardien ; 2 => defenseur ; 3 => milieu ; 4 => attaquant \n");
            }
                scanf("%d",&p);
                switch (p) {
                case 1:
                    strcpy(j[nombre_joueur].poste,"guardien");
                    break;
                case 2:
                    strcpy(j[nombre_joueur].poste,"defenseur");
                    break;
                case 3:
                    strcpy(j[nombre_joueur].poste,"milieu");
                    break;
                case 4:
                    strcpy(j[nombre_joueur].poste,"attaquant");
                    break;
                default :
                    printf("error! entrer un nombre entre 1 et 4 ");
                    goto menu_poste;
                    break;
                }
        
           j[nombre_joueur].id = counter_id++;
           printf("entrer l'age du joueur : \n");
           scanf("%d",&j[nombre_joueur].age);
           printf("entrer le nombre des buts du joueur : \n");
           scanf("%d",&j[nombre_joueur].buts);
           nombre_joueur++;
        } else {
           printf("la liste des joueurs est complete : ");
        }
} 
void ajoute_plusieur_joueur() {
    int x,i;
    printf("entrer le nombre du joueur que tu veux ajouter : \n");
    scanf("%d", &x);
        for (i = 0;i < x;i++) {
            ajoute_joueur();
        }
}

void afficher_joueurs() {
    for (int i = 0; i < nombre_joueur; i++) {
        printf("nom : %s ; prenom : %s ;numero_maillot : %d ; post : %s ; age du joueur : %d ; id : %d ",j[i].nom,j[i].prenom,j[i].numero_maillot,j[i].poste,j[i].age,j[i].id);
    }
}

void tri_alphabetique() {
    int i ,k;
    joueur variable_tomporaire;
    for (i = 0; i < nombre_joueur-1;i++) {
        for (k = 0; k < nombre_joueur-1-i;k++) {
            if (strcmp(j[k].nom, j[k+1].nom) > 0) {
                variable_tomporaire = j[k];
                j[k] = j[k+1];
                j[k+1] = variable_tomporaire;
            }
        }
    }
    printf("tri par ordre alphabetique \n");
    afficher_joueurs();
}
void tri_age() {
    joueur variable_tomporaire;
    for (int i = 0; i < nombre_joueur-1; i++) {
        for (int k = 0; k < nombre_joueur-1-i; k++) {
            if (j[k].age > j[k+1].age) {
                variable_tomporaire = j[k];
                j[k] = j[k+1];
                j[k+1] = variable_tomporaire;
            }
        }
    }
    printf("la liste d'equipe trier par age :  ");
    afficher_joueurs();
}
void tri_poste() {
    char poste_entrer[10];
    printf("entrer le post (gardien/defenseur/milieu/attaquant) : ");
    scanf("%s", poste_entrer);

    printf("joueurs a le poste %s \n",poste_entrer);
    for (int i = 0; i < nombre_joueur; i++) {
        if (strcmp(j[i].poste,poste_entrer) == 0) {
             printf("nom : %s ; prenom : %s ;numero_maillot : %d ; post : %s ; age du joueur : %d ; id : %d ",j[i].nom,j[i].prenom,j[i].numero_maillot,j[i].poste,&j[i].age,&j[i].id);
        }
    }
}

void modification_poste() {
     int id,i;
    printf("entrer l'id du joueur pour modifier le poste : \n");
        scanf("%d",&id);

    for (i = 0; i < nombre_joueur; i++) {
        if (j[i].id == id) {
            int choix;
            menu_poste : {
            printf("1 => gardien ; 2 => defenseur ; 3 => milieu ; 4 => attaquant \n");
            printf("entrer le nouvelle poste : \n");
        }
                scanf("%d", &choix);
            switch (choix) {
                case 1: 
                   strcpy(j[i].poste,"gardien"); 
                   break;
                case 2: 
                    strcpy(j[i].poste,"defenseur"); 
                    break;
                case 3: 
                    strcpy(j[i].poste,"milieu"); 
                    break;
                case 4: 
                    strcpy(j[i].poste,"attaquant"); 
                    break;
                default: 
                    printf("error! entrer un entier entre 1 et 4 : \n"); 
                    goto menu_poste;
                    break;
            }
            printf("le poste  a ete modifier en succe : \n");
            return;
        }
    }
    printf("la joueur avec l'id %d n'exist pas dans la liste des joueurs ; \n",id);
}
void modification_age() {
    int id ,i ,nouvelle_age;
    printf("entrer l'id du joueur pour modifier l'age : \n");
        scanf("%d",&id);
    for(i = 0;i < nombre_joueur ; i++) {
       if(j[i].id == id ) {
            printf("entrer la nouvelle age du joueur : \n");
                scanf("%d",&nouvelle_age);
                    j[i].age == nouvelle_age;
            printf("l'age du joueura ete modifier en succe \n");
            return;
       }
    }
    printf("la joueur avec l'id %d n'exist pas dans la liste des joueurs ; \n",id);
}
void modification_buts() {
    int id ,i ,nouvelle_buts;
    printf("entrer l'id du joueur pour modifier le nombre des buts : \n");
        scanf("%d",&id);
    for(i = 0;i < nombre_joueur ; i++) {
       if(j[i].id == id ) {
            printf("entrer la nouvelle age du joueur : \n");
                scanf("%d",&nouvelle_buts);
                    j[i].buts == nouvelle_buts;
            printf("le nombre des buts du joueur a ete modifier en succe \n");
            return;
       }
    }
    printf("la joueur avec l'id %d n'exist pas dans la liste des joueurs ; \n",id);
}

void supretion() {
   int id ,i ,k;
    printf("entrer l'id du joueur pour suprime : \n");
        scanf("%d",&id);
    for(i = 0;i < nombre_joueur;i++) {
        if(j[i].id == id){
        for (k = i; k < nombre_joueur-1;k++) {
             j[k] = j[k+1];
        }
        nombre_joueur--;
        printf("lejoueur a ete suprime en succe ");
        return;
        }
        }
    printf("la joueur avec l'id %d n'exist pas dans la liste des joueurs ; \n",id);

}

void recherche_id() {   
    int id ,i;
    printf("entrer l'id du joueur que tu veux cherche : \n");
        scanf("%d",&id);
    for(i = 0;i < nombre_joueur ; i++) {
       if(j[i].id == id ) {
            printf("joueur aved l'id %d \n",id);
             printf("nom : %s ; prenom : %s ;numero_maillot : %d ; post : %s ; age du joueur : %d ; id : %d ",j[i].nom,j[i].prenom,j[i].numero_maillot,j[i].poste,&j[i].age,&j[i].id);
            return;
       }
    }
    printf("la joueur avec l'id %d n'exist pas dans la liste des joueurs ; \n",id); 
}
void recherche_nom() {
    int i;
    char entrer_nom[20];
    printf("entrer le nom du joueur que tu veux cherche : \n");
        scanf("%s", entrer_nom);
    for(i = 0;i < nombre_joueur ; i++) {
       if(strcpy(j[i].nom , entrer_nom) == 0 ) {
            printf("joueur aved le nom : %d \n",entrer_nom);
             printf("nom : %s ; prenom : %s ;numero_maillot : %d ; post : %s ; age du joueur : %d ; id : %d ",j[i].nom,j[i].prenom,j[i].numero_maillot,j[i].poste,&j[i].age,&j[i].id);
            return;
       }
    }
    printf("la joueur avec le nom %s n'exist pas dans la liste des joueurs ; \n",entrer_nom); 
}

void affiche_age_moyenne() {
    int i ,somme = 0;
    float moyenne;
    for(i = 0;i < nombre_joueur;i++) {
        somme += j[i].age;
    }
    moyenne = somme/nombre_joueur;
    printf("la moyenne d'age des joueur est : %.2f \n ",moyenne);
}
void affiche_joueur_marque_plusX() {
    int i ,nombre_but;
    printf("entrer le nombre des buts : \n");
      scanf("%d",&nombre_but); 
    int trouve = 0; 
    for (i = 0;i < nombre_joueur;i++) {
        if (j[i].buts <= nombre_but) {
            trouve++;
            printf("nom : %s ; prenom : %s ;numero_maillot : %d ; post : %s ; age du joueur : %d ; id : %d ",j[i].nom,j[i].prenom,j[i].numero_maillot,j[i].poste,j[i].age,j[i].id);
        }
    } 
    if (trouve == 0) {
        printf("aucune joueur marque des buts plus que %d  \n",nombre_but);
    }
}
void affiche_buteur() {
    int i;
   int max_but = j[0].buts;
   int indice_butteur;
   for (i= 1;i < nombre_joueur;i++) {
      if(j[i].buts > max_but) {
        max_but = j[i].buts;
        indice_butteur = i;
      }
   }
   printf("le joueur marque le plus de but : \n");
   printf("nom : %s ; prenom : %s ;numero_maillot : %d ; post : %s ; age du joueur : %d ; id : %d ",j[i].nom,j[i].prenom,j[i].numero_maillot,j[i].poste,j[i].age,j[i].id);
}
void affiche_plusjeune_plusage() {
    
    int i;
   int max_age = j[0].age;
   int indice_max_age;
   for(i = 1; i < nombre_joueur;i++) {
       if (j[i].age > max_age) {
        max_age = j[i].age;
        indice_max_age = i;
       }
   }

   int min_age = j[0].age;
   int indice_min_age;
   for(i = 1; i < nombre_joueur;i++) {
       if (j[i].age < min_age) {
        max_age = j[i].age;
        indice_min_age = i;
       }
   }
   
   printf("le joueur le plus age : \n");
    printf("nom : %s ; prenom : %s ;numero_maillot : %d ; post : %s ; age du joueur : %d ; id : %d ",j[indice_max_age].nom,j[indice_max_age].prenom,j[indice_max_age].numero_maillot,j[indice_max_age].poste,j[indice_max_age].age,j[indice_max_age].id);
   
   printf("le joueur le plus jeune : \n");
    printf("nom : %s ; prenom : %s ;numero_maillot : %d ; post : %s ; age du joueur : %d ; id : %d ",j[indice_min_age].nom,j[indice_min_age].prenom,j[indice_min_age].numero_maillot,j[indice_min_age].poste,j[indice_min_age].age,j[indice_min_age].id);
}

int main() {

    int  id_joueur = 110;
    int choix_principale ,choix_ajoute ,choix_affiche ,choix_modification ,choix_statistiques ,choix_recherche;
    
    
    menu : {
    printf("=========menu==========\n");
    printf("1 => Ajouter un joueur : \n");
    printf("2 => Afficher la liste de tous les joueurs : \n");
    printf("3 => Modifier un joueur : \n");
    printf("4 => Supprimer un joueur : \n");
    printf("5 => Rechercher un joueur : \n");
    printf("6 => Statistiques : : \n");
    }
      scanf("%d",&choix_principale);
       
    switch (choix_principale) {
        case 1 :
            
            menu1 : {
            printf("1 => ajoute une joueur : \n");
            printf("2 => ajoute plusieur joueur : \n");
            printf("3 => reteur au menu principale : \n");
            }
              scanf("%d",&choix_ajoute);
              
               switch(choix_ajoute){
                
                   case 1: ajoute_joueur();
                        goto menu1;
                        break;
                   case 2: ajoute_plusieur_joueur();
                        goto menu1;
                        break;
                   case 3: goto menu;
                       break;
                    default: printf("entrer un nombre entre 1 et 3 : ");
                       goto menu1; 
                      break;
            }
            
           break;
        case 2 : 
            menu2 : {
                printf("1 => Trier les joueurs par ordre alphabétique (Nom) : \n");
                printf("2 => Trier les joueurs par âge. : \n");
                printf("3 => Afficher les joueurs par poste. : \n");
                printf("4 => reteur au menu principale : \n");
            }
            scanf("%d",&choix_affiche);
            
            switch(choix_affiche) {
                case 1 : 
                    tri_alphabetique(); 
                    goto menu2;
                    break;
                case 2 : 
                    tri_age();
                    goto menu2;
                    break;
                case 3 : 
                   tri_poste();
                   goto menu2;
                   break;
                case 4: goto menu; 
                       break;
                default: printf("entrer un nombre entre 1 et 4 : \n");
                       goto menu2; 
                      break;
            }
            
           break;
        case 3 : 
             menu3 : {
                 printf("Modifier le poste du'n joueur : \n");
                 printf("Modifier l'âge d'un joueur: \n");
                 printf("Modifier le nombre de buts marqués par un joueur : \n");
                 printf("4 => reteur au menu principale : \n");
             }
             scanf("%d",&choix_modification);
             
            switch(choix_modification) {
                case 1 : 
                    modification_poste(); 
                    goto menu3;
                    break;
                case 2 : 
                    modification_age();
                    goto menu3;
                    break;
                case 3 : 
                    modification_buts();
                    goto menu3;
                    break;
                case 4: goto menu; 
                       break;
                default: printf("entrer un nombre entre 1 et 4 : ");
                       goto menu3; 
                      break;
            }
             
           break;
        case 4 :
            supretion();
           break;
        case 5 :
           menu4 : {
               printf("1 => recherche par id : \n");
               printf("2 => recherche par nom : \n");
               printf("3 => reteur au menu principale : \n");
           }
           scanf("%d",&choix_recherche);

           switch (choix_recherche) {
           case 1 : 
               recherche_id();
               goto menu4;
               break;
           case 2 : 
               recherche_nom();
               goto menu4;
               break;
           case 3 : goto menu;
               break;
           default: printf("entrer un nombre entre 1 et 3 : ");
                       goto menu4; 
                      break;
           }          
           
        case 6 :
           menu5 : {
               printf("1 => Afficher le nombre total de joueurs dans l'equipe : \n");
               printf("2 => Afficher l'âge moyen des joueurs : \n");
               printf("3 => Afficher les joueurs ayant marqué plus de X buts (X introduit par l'utilisateur) : \n");
               printf("4 => Afficher le meilleur buteur (joueur avec le maximum de buts) : \n");
               printf("5 => Afficher le joueur le plus jeune et le plus âgé : \n");
               printf("6 => reteur au menu principale : \n");
           }
           scanf("%d",choix_statistiques);
           
           switch (choix_statistiques) {
               case 1 : 
                  printf("le nombre total du joueurs dans la liste est : %d\n", nombre_joueur);
                  goto menu5;
                  break;
               case 2 : 
                  affiche_age_moyenne();
                  goto menu5;
                  break;
               case 3 : 
                  affiche_joueur_marque_plusX();
                  goto menu5;
                  break;
               case 4 : 
                  affiche_buteur();
                  goto menu5;
                  break;
               case 5 : 
                  affiche_plusjeune_plusage();
                  goto menu5;
                  break;
               case 6 : goto menu;
               break;
            default: printf("entrer un nombre entre 1 et 6 : ");
                       goto menu5; 
                      break;  
           }
           
           break;
        default : printf("saisir une nombre entre (1/6) : \n");
                 goto menu;  
           break ;
    }

    
    return 0;
}
